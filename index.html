<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Insta 3-Slicer — Upload & Split into 3</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,\"Noto Sans\",Ubuntu,"Helvetica Neue",Arial;margin:18px;background:#0f172a;color:#e6eef8}
    .card{background:linear-gradient(180deg,#0b1220, #0f172a);padding:18px;border-radius:12px;box-shadow:0 6px 24px rgba(2,6,23,.6);max-width:820px;margin:0 auto}
    h1{font-size:20px;margin:0 0 8px}
    p{margin:6px 0 14px;color:#a9bfd6}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    input[type=file]{padding:8px;background:#071024;border-radius:8px;border:1px solid #15304a;color:#cfe7ff}
    button{background:#2563eb;color:white;border:0;padding:10px 12px;border-radius:8px;cursor:pointer}
    button:disabled{opacity:.5;cursor:default}
    canvas{max-width:100%;border-radius:8px;border:1px solid rgba(255,255,255,.04);background:#071428}
    .downloads{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
    .dl-btn{background:#10b981;padding:8px 10px;border-radius:8px;color:#022;display:inline-block;text-decoration:none}
    .note{font-size:13px;color:#89b0d8;margin-top:10px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Insta 3‑Slicer</h1>
    <p>Upload any image — this tool slices it into <strong>3 equal vertical parts</strong> (original resolution preserved). Download each slice and post to Instagram as 3 grid squares.</p>

    <div class="controls">
      <input id="file" type="file" accept="image/*" />
      <button id="sliceBtn" disabled>Slice into 3</button>
      <button id="resetBtn" disabled>Reset</button>
    </div>

    <div style="margin-top:12px">
      <canvas id="preview" width="720" height="360"></canvas>
    </div>

    <div class="downloads" id="downloads"></div>
    <div class="note">Tip: If Instagram requires square uploads for perfect grid alignment, use each slice and export as <strong>1080×1080</strong> (you can resize each slice in an editor). This tool preserves original pixels.</div>
  </div>

<script>
const fileInput = document.getElementById('file');
const sliceBtn = document.getElementById('sliceBtn');
const resetBtn = document.getElementById('resetBtn');
const preview = document.getElementById('preview');
const ctx = preview.getContext('2d');
const downloads = document.getElementById('downloads');
let img = new Image();
let imgLoaded = false;
let originalWidth = 0, originalHeight = 0;
let objectURL = null;

fileInput.addEventListener('change', e => {
  const f = e.target.files[0];
  if(!f) return;
  if(objectURL) URL.revokeObjectURL(objectURL);
  objectURL = URL.createObjectURL(f);
  img = new Image();
  img.onload = ()=>{
    imgLoaded = true;
    originalWidth = img.naturalWidth;
    originalHeight = img.naturalHeight;
    // fit preview canvas while keeping aspect
    const maxW = 760; const maxH = 360;
    let pw = originalWidth, ph = originalHeight;
    const ratio = Math.min(maxW / pw, maxH / ph, 1);
    preview.width = Math.round(pw * ratio);
    preview.height = Math.round(ph * ratio);
    ctx.clearRect(0,0,preview.width,preview.height);
    ctx.drawImage(img,0,0,preview.width,preview.height);
    sliceBtn.disabled = false;
    resetBtn.disabled = false;
    downloads.innerHTML = '';
  };
  img.src = objectURL;
});

sliceBtn.addEventListener('click', ()=>{
  if(!imgLoaded) return;
  downloads.innerHTML = '';
  const slices = 3;
  const sliceWidth = Math.floor(originalWidth / slices);
  // Offscreen canvas to create each slice at original resolution
  for(let i=0;i<slices;i++){
    const sx = i * sliceWidth;
    // last slice should include remainder pixels
    const sw = (i === slices-1) ? (originalWidth - sx) : sliceWidth;
    const c = document.createElement('canvas');
    c.width = sw; c.height = originalHeight;
    const cc = c.getContext('2d');
    cc.drawImage(img, sx, 0, sw, originalHeight, 0, 0, sw, originalHeight);
    // create download link
    c.toBlob(blob => {
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `slice_${i+1}.png`;
      a.className = 'dl-btn';
      a.textContent = `Download slice ${i+1}`;
      downloads.appendChild(a);
    }, 'image/png');
  }
  // Also show a quick preview of the split as small canvases
  // draw preview grid
  const ratio = preview.width / originalWidth;
  ctx.clearRect(0,0,preview.width,preview.height);
  for(let i=0;i<slices;i++){
    const sx = i * sliceWidth;
    const sw = (i === slices-1) ? (originalWidth - sx) : sliceWidth;
    ctx.drawImage(img, sx, 0, sw, originalHeight, Math.round(sx*ratio), 0, Math.round(sw*ratio), preview.height);
    ctx.strokeStyle = 'rgba(255,255,255,0.06)';
    ctx.lineWidth = 2;
    ctx.strokeRect(Math.round(sx*ratio),0,Math.round(sw*ratio),preview.height);
  }
});

resetBtn.addEventListener('click', ()=>{
  fileInput.value = '';
  if(objectURL) URL.revokeObjectURL(objectURL);
  imgLoaded = false;
  sliceBtn.disabled = true;
  resetBtn.disabled = true;
  downloads.innerHTML = '';
  ctx.clearRect(0,0,preview.width,preview.height);
});
</script>
</body>
</html>
